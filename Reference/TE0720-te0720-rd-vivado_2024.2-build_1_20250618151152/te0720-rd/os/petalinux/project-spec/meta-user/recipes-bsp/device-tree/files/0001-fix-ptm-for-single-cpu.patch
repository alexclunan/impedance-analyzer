From d2f33fc70e61c3aab4f5a4566b428f007af9a82f Mon Sep 17 00:00:00 2001
From: Markus Kirberg <m.kirberg@trenz-electronic.de>
Date: Mon, 19 May 2025 09:25:37 +0200
Subject: [PATCH] [PATCH] fix ptm for single cpu

---
 device_tree/data/device_tree.tcl | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/device_tree/data/device_tree.tcl b/device_tree/data/device_tree.tcl
index 125fc927..328b6e8f 100644
--- a/device_tree/data/device_tree.tcl
+++ b/device_tree/data/device_tree.tcl
@@ -1086,6 +1086,12 @@ proc update_cpu_node {os_handle} {
         if {[llength $proc_name] == 0} {
             set cpu_node [add_or_get_dt_node -n "cpus" -d ${default_dts} -p ${system_root_node}]
             hsi::utils::add_new_dts_param "${cpu_node}" "/delete-node/ cpu@$i" "" boolean
+            
+             #also treat ptm
+             set axi_node [add_or_get_dt_node -n "&amba" -d ${default_dts}]
+             set ptm [add_or_get_dt_node -n "ptm@f889d000" -d ${default_dts} -p $axi_node]
+             hsi::utils::add_new_dts_param "${ptm}" "cpu" "cpu0" aliasref
+            
             continue
         }
 	if {[string match -nocase [get_property IP_NAME [get_cells -hier $proc_name]] "microblaze"]} {
-- 
